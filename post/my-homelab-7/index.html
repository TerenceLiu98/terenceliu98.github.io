<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="https://blog.cklau.cc/images/logo.svg" />
<title>üßëüèø‚Äçüíª Homelab: CloudFlare is All you Need | ÁâπÂÄ´ËòáÁöÑÊó•ËàáÂ§ú</title>
<meta name="title" content="üßëüèø‚Äçüíª Homelab: CloudFlare is All you Need" />
<meta name="description" content="ÂõûÂà∞ÂéüÁÇπÔºåÂèàÂºÄÂßã‰∫Ü‰∏ÄÂπ¥‰∏ÄÂ∫¶ÁöÑ Homelab ÊäòËÖæ„ÄÇËøô‰∏ÄÊ¨°Ôºå ÊâìÁÆóÊï¥ÁÇπ„ÄåËµ∑Â§ú„ÄçÁ∫ßÊñπÊ°à :)" />
<meta name="keywords" content="homelab,networking,hardware,ÁΩëÁªú,Â≠òÂÇ®,NAS," />


<meta property="og:title" content="üßëüèø‚Äçüíª Homelab: CloudFlare is All you Need" />
<meta property="og:description" content="ÂõûÂà∞ÂéüÁÇπÔºåÂèàÂºÄÂßã‰∫Ü‰∏ÄÂπ¥‰∏ÄÂ∫¶ÁöÑ Homelab ÊäòËÖæ„ÄÇËøô‰∏ÄÊ¨°Ôºå ÊâìÁÆóÊï¥ÁÇπ„ÄåËµ∑Â§ú„ÄçÁ∫ßÊñπÊ°à :)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.cklau.cc/post/my-homelab-7/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2024-08-10T00:11:21+08:00" />
<meta property="article:modified_time" content="2024-08-10T00:11:21+08:00" />




<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="üßëüèø‚Äçüíª Homelab: CloudFlare is All you Need"/>
<meta name="twitter:description" content="ÂõûÂà∞ÂéüÁÇπÔºåÂèàÂºÄÂßã‰∫Ü‰∏ÄÂπ¥‰∏ÄÂ∫¶ÁöÑ Homelab ÊäòËÖæ„ÄÇËøô‰∏ÄÊ¨°Ôºå ÊâìÁÆóÊï¥ÁÇπ„ÄåËµ∑Â§ú„ÄçÁ∫ßÊñπÊ°à :)"/>



<meta itemprop="name" content="üßëüèø‚Äçüíª Homelab: CloudFlare is All you Need">
<meta itemprop="description" content="ÂõûÂà∞ÂéüÁÇπÔºåÂèàÂºÄÂßã‰∫Ü‰∏ÄÂπ¥‰∏ÄÂ∫¶ÁöÑ Homelab ÊäòËÖæ„ÄÇËøô‰∏ÄÊ¨°Ôºå ÊâìÁÆóÊï¥ÁÇπ„ÄåËµ∑Â§ú„ÄçÁ∫ßÊñπÊ°à :)"><meta itemprop="datePublished" content="2024-08-10T00:11:21+08:00" />
<meta itemprop="dateModified" content="2024-08-10T00:11:21+08:00" />
<meta itemprop="wordCount" content="415">
<meta itemprop="keywords" content="homelab,networking,hardware,ÁΩëÁªú,Â≠òÂÇ®,NAS," />
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  body {
    font-family: "Noto Serif SC", serif;
    font-weight: 500;
    font-style: normal;
    margin: auto;
    padding: 20px;
    max-width: 980px;
    text-align: left;
    background-color: #fff;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: #444;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  strong,
  b {
    color: #222;
  }

  a {
    color: #444;
    text-decoration: none;
     
  }

  .title {
    text-decoration: none;
    border: 0;
  }

  .title span {
    font-weight: 400;
  }

  nav a {
    margin-right: 10px;
  }

  textarea {
    width: 100%;
    font-size: 16px;
  }

  input {
    font-size: 16px;
  }

  content {
    line-height: 1.6;
  }

  main content p a {
    word-wrap: break-word;
    border: none;
    box-shadow: inset 0 -2px #444;
    transition-property: box-shadow;
    transition-duration: .1s;
  }

  table {
    width: 100%;
  }

  img {
    max-width: 100%;
  }

  code {
    padding: 2px 5px;
    background-color: #f2f2f2;
  }

  pre code {
    color: #222;
    display: block;
    padding: 20px;
    white-space: pre-wrap;
    font-size: 14px;
    overflow-x: auto;
  }

  div.highlight pre {
    background-color: initial;
    color: initial;
  }

  div.highlight code {
    background-color: unset;
    color: unset;
  }

  blockquote {
    border-left: 1px solid #999;
    color: #222;
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px;
    text-align: center;
  }

  .helptext {
    color: #777;
    font-size: small;
  }

  .errorlist {
    color: #eba613;
    font-size: small;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
    line-height: 2;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 6.5rem;
  }

  ul.blog-posts li time {
    color: #8e8d8d;
  }

  ul.blog-posts li a:visited {
    color: #8b6fcb;
  }


   


  .bg { background-color: #f0f0f0; }
  .chroma { background-color: #f0f0f0; }
  .chroma .x {  }
  .chroma .err {  }
  .chroma .cl {  }
  .chroma .lnlinks { outline: none; text-decoration: none; color: inherit }
  .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
  .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; }
  .chroma .hl { background-color: #ffffcc }
  .chroma .lnt { white-space: pre; user-select: none; margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
  .chroma .ln { white-space: pre; user-select: none; margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
  .chroma .line { display: flex; }
  .chroma .k { color: #007020; font-weight: bold }
  .chroma .kc { color: #007020; font-weight: bold }
  .chroma .kd { color: #007020; font-weight: bold }
  .chroma .kn { color: #007020; font-weight: bold }
  .chroma .kp { color: #007020 }
  .chroma .kr { color: #007020; font-weight: bold }
  .chroma .kt { color: #902000 }
  .chroma .n {  }
  .chroma .na { color: #4070a0 }
  .chroma .nb { color: #007020 }
  .chroma .bp {  }
  .chroma .nc { color: #0e84b5; font-weight: bold }
  .chroma .no { color: #60add5 }
  .chroma .nd { color: #555555; font-weight: bold }
  .chroma .ni { color: #d55537; font-weight: bold }
  .chroma .ne { color: #007020 }
  .chroma .nf { color: #06287e }
  .chroma .fm {  }
  .chroma .nl { color: #002070; font-weight: bold }
  .chroma .nn { color: #0e84b5; font-weight: bold }
  .chroma .nx {  }
  .chroma .py {  }
  .chroma .nt { color: #062873; font-weight: bold }
  .chroma .nv { color: #bb60d5 }
  .chroma .vc {  }
  .chroma .vg {  }
  .chroma .vi {  }
  .chroma .vm {  }
  .chroma .l {  }
  .chroma .ld {  }
  .chroma .s { color: #4070a0 }
  .chroma .sa { color: #4070a0 }
  .chroma .sb { color: #4070a0 }
  .chroma .sc { color: #4070a0 }
  .chroma .dl { color: #4070a0 }
  .chroma .sd { color: #4070a0; font-style: italic }
  .chroma .s2 { color: #4070a0 }
  .chroma .se { color: #4070a0; font-weight: bold }
  .chroma .sh { color: #4070a0 }
  .chroma .si { color: #70a0d0 }
  .chroma .sx { color: #c65d09 }
  .chroma .sr { color: #235388 }
  .chroma .s1 { color: #4070a0 }
  .chroma .ss { color: #517918 }
  .chroma .m { color: #40a070 }
  .chroma .mb { color: #40a070 }
  .chroma .mf { color: #40a070 }
  .chroma .mh { color: #40a070 }
  .chroma .mi { color: #40a070 }
  .chroma .il { color: #40a070 }
  .chroma .mo { color: #40a070 }
  .chroma .o { color: #666666 }
  .chroma .ow { color: #007020; font-weight: bold }
  .chroma .p {  }
  .chroma .c { color: #60a0b0; font-style: italic }
  .chroma .ch { color: #60a0b0; font-style: italic }
  .chroma .cm { color: #60a0b0; font-style: italic }
  .chroma .c1 { color: #60a0b0; font-style: italic }
  .chroma .cs { color: #60a0b0; background-color: #fff0f0 }
  .chroma .cp { color: #007020 }
  .chroma .cpf { color: #007020 }
  .chroma .g {  }
  .chroma .gd { color: #a00000 }
  .chroma .ge { font-style: italic }
  .chroma .gr { color: #ff0000 }
  .chroma .gh { color: #000080; font-weight: bold }
  .chroma .gi { color: #00a000 }
  .chroma .go { color: #888888 }
  .chroma .gp { color: #c65d09; font-weight: bold }
  .chroma .gs { font-weight: bold }
  .chroma .gu { color: #800080; font-weight: bold }
  .chroma .gt { color: #0044dd }
  .chroma .gl { text-decoration: underline }
  .chroma .w { color: #bbbbbb }


 
.sidenote {
    font-size: 80%;         
    font-weight: normal;
    color: var(--theme-hl1-color);
    position: relative;     
}
 
@media (min-width: 1400px) {
    .sidenote {
        float: right;
        clear: right;            
        text-align: left;

         
            
        top: -3rem;             
        width: 20vw;            
        margin-right: -23vw;     
        margin-top: 1rem;       
    }
}
 
 
@media (max-width: 1400px) {
    .sidenote {
         
        float: right;
        text-align: left;

            
        width: 100%;  
        margin: 1rem 0;
        padding-left: 5%;  
    }
}
 
 
body {
    counter-reset: sidenote-counter;
}
.sidenote-number {
    counter-increment: sidenote-counter;
}
 
.sidenote::before {
    content: "\2020";
    position: relative;
    vertical-align: super;
    font-size: 0.9em;
    font-weight: bold;
}
 
.sidenote-number::after {
    content: "\2020";
    position: relative;
    vertical-align: super;
    font-size: 0.7em;
    font-weight: bold;
    color: var(--theme-body-color);
    display: inline;
    margin-right: 0.2rem;
}
@media (min-width: 1400px) {
     
    .sidenote-number:hover .sidenote {
        background-color: var(--theme-color-light);
    }
}

  
.card-container {
    display: flex;
    flex-direction: column;
    align-items: center;  
    gap: 5px;  
    padding: 5px;
}

.card {
    width: 80%;  
    box-shadow: 0 0px 0px rgba(0,0,0,0.1);  
    display: flex;
    align-items: center;  
    padding: 10px;
    background: white;  
    text-decoration: none;  
    color: inherit;  
}

.card img {
    width: 80px;  
    height: 80px;
    border-radius: 50%;  
    margin-right: 20px;  
}

.card .info h2 {
    margin: 0;
    font-size: 1.2em;  
}

.card .info p {
    margin: 5px 0 0;  
    font-size: 0.9em;
    color: #444;  
}
.card .info span{
    font-size: 0.5em;
    color: #666;
}
</style>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500&display=swap" rel="stylesheet">
<script defer data-domain="nova.moe" src="https://possible.knat.network/js/script.js"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1844674035384472" crossorigin="anonymous"></script>
<link rel="alternate" type="application/rss+xml" href="https://blog.cklau.cc/feed.xml" title="ÁâπÂÄ´ËòáÁöÑÊó•ËàáÂ§ú">

</head>

<body>
  <header><a href="/" class="title">
  <h2>ÁâπÂÄ´ËòáÁöÑÊó•ËàáÂ§ú</h2>
</a>
<nav><a href="/">Home</a>

<a href="/post">[Blog]</a>

<a href="/post/scientia">[Scientia]</a>

<a href="/links">[Links]</a>

</nav>
</header>
  <main>
<h1>üßëüèø‚Äçüíª Homelab: CloudFlare is All you Need</h1>
<p>
  <i>
    <time datetime='2024-08-10' pubdate>
      10 Aug, 2024
    </time>
  </i>
</p>

<content>
  <p>ÂõûÂà∞ÂéüÁÇπÔºåÂèàÂºÄÂßã‰∫Ü‰∏ÄÂπ¥‰∏ÄÂ∫¶ÁöÑ Homelab ÊäòËÖæ„ÄÇËøô‰∏ÄÊ¨°Ôºå ÊâìÁÆóÊï¥ÁÇπ„ÄåËµ∑Â§ú„ÄçÁ∫ßÊñπÊ°à :)</p>
<p>‰Ωï‰∏∫‰ºÅ‰∏öÁ∫ßÊñπÊ°à?</p>
<p>Â§ßËá¥Êù•ËØ¥ÔºåÂ∞±ÊòØÂæàÁ®≥ÔºåÈùûÂ∏∏Á®≥ÔºåÂçÅÂàÜÊúâÂçÅ‰∫åÂàÜÁöÑÁ®≥„ÄÇËá≥Â∞ëÊòØÊ≠£ÂêëÊé®ÁêÜÁöÑÊó∂ÂÄôÊòØËøôÊ†∑ÁöÑÔºåËá≥‰∫éÊÑèÂ§ñÊÉÖÂÜµÔºå‰∏çÂàóÂÖ•ËÄÉËôëËåÉÂõ¥<span class="sidenote-number">
	<small class="sidenote">
	‰Ωú‰∏∫‰ºÅ‰∏öÁ∫ßÊñπÊ°àÔºåËá™ÁÑ∂ÈúÄË¶ÅÊòØÈúÄË¶ÅÂ∫îÊÄ•È¢ÑÊ°àÔºåËá≥‰∫éËÉΩ‰∏çËÉΩÈÅá‰∏äÂ∞±ÂÜçËÆÆ
	</small>
</span>„ÄÇ ÈÇ£‰πà‰Ωú‰∏∫‰∏Ä‰∏™ <code>yaml</code> Áé©ÂÆ∂ÔºåËá™ÁÑ∂ËÄåÁÑ∂ÁöÑÈÄâÊã©Â∞±Âè™‰ºöËêΩÂú® Kubernetes ‰πã‰∏äÔºåËá≥‰∫éÂ¶Ç‰ΩïÈÄöËøá <code>kubeadm</code> Êê≠Âª∫È´òÂèØÁî®ÁöÑ K8s ÈõÜÁæ§Ôºå‰∏çÂú®Êú¨ÊñáËÆ®ËÆ∫ËåÉÂõ¥‰πãÂÜÖÔºåËØ∑ÂèÇËÄÉ‰ª•ÂâçÁöÑÊñáÁ´†„ÄÇ ÂΩìÁÑ∂Ôºå‰∏∫‰∫Ü<ruby >
    <span>Â¢ûÂä†ÂèØËÆøÈóÆÊÄß</span>
    <rp>(</rp><rt >
            ÁªïËøáÂüüÂêçÂ§áÊ°à</rt><rp>)</rp>
</ruby>ÔºåÊàëÁöÑÁ¨¨‰∏ÄÈÄâÊã©ÂΩìÊó∂ÊòØÈÄâÊã©Âú∞Â§ÑÈ¶ôÊ∏ØÁöÑÊúçÂä°Âô®‰Ωú‰∏∫ÈõÜÁæ§ÁöÑ‰∏ªÊéßËäÇÁÇπ„ÄÇÊó†Ê≥ïÂê¶ËÆ§ÁöÑÊòØÔºåAWS/Azure/GCP ÁöÑÊúçÂä°Âô®ÊòØÊàëÁ≠âÁ©∑Â≠¶ÁîüÊó†Ê≥ïË¥üÊãÖÂæóËµ∑ÁöÑÔºåËÄåÂ∞è‰ºóÂïÜÂÆ∂ÂèàÊúâÁùÄÊ¶ÇÁéáË∑ëË∑Ø/ËæÉÈ´òÊ¶ÇÁéáË¢´ÊîªÂáªÔºåÊú¨ÁùÄ„ÄåËµ∑Â§úÁ∫ß„ÄçÁöÑÊÄùÊÉ≥ÔºåÊúÄÁªàÂ∞ÜÈõÜÁæ§ÁöÑ‰∏ªÊéßËäÇÁÇπÂÆöÂú®‰∫ÜÂêÉÁÅ∞‰∏≠ÁöÑËÖæËÆØ‰∫ëÂπøÂ∑ûËΩªÈáèÂ∫îÁî®ÊúçÂä°Âô®ÔºàÁ®≥ÂÆö‰∏î‰ΩéÂª∂ËøüÔºâ„ÄÇ</p>
<p>Âú®ÁªèËøáÂæàÂ§öÂπ¥ÁöÑÂ§ßÊµ™Ê∑òÊ≤ô‰πãÂêéÔºåÊâãÈáå‰ªÖÂâ©‰∏ã‰∏§Âè∞Êú∫Âô®<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>Ôºå‰∏ÄÂè∞‰Ωú‰∏∫‰∏ªÂ≠òÂÇ®ËäÇÁÇπ (Riemann)ÔºåËÄåÂè¶Â§ñ‰∏ÄÂè∞ÂàôÊòØËÆ°ÁÆóËäÇÁÇπ (Nexus)ÔºåÊØîËæÉÊúâÊÑèÊÄùÁöÑÊòØÔºåËÆ°ÁÆóËäÇÁÇπ‰∏äÂÖ∂ÂÆû‰πüÊèí‰∫Ü‰∏Ä‰∫õÂ≠òÂÇ®Áî®ÁöÑÁ°¨ÁõòËÄåÂ≠òÂÇ®ËäÇÁÇπ‰∏ä‰πüÊúâ‰∏Ä‰∫õËÆ°ÁÆóËµÑÊ∫ê„ÄÇ‰∏∫‰∫Ü‰∏çÊµ™Ë¥πÂ≠òÂÇ®‰∏îÂÆåÊàê„ÄåËµ∑Â§ú„ÄçÁ∫ßÁöÑ‰∏≠ÂøÉÊÄùÊÉ≥ÔºåÊàëÈÄâÊã©‰∫Ü GlusterFS ‰Ωú‰∏∫‰∏ªË¶ÅÁöÑÊñá‰ª∂Á≥ªÁªü„ÄÇËØöÁÑ∂Ôºå Ceph ÊâçÊòØ‰∏ªÊµÅÔºåGlusterFS ËøôÁßçÁâõÂ§´‰∫∫ÊâçÊòØ<del>Á®≥ÂÆöÂèØÈù†‰πãÈÄâ</del>„ÄÇ</p>
<p>‰∏ÄÂàáÈÉ®ÁΩ≤ÂÆåÊØï‰ª•ÂêéÔºåÂ¶Ç‰ΩïËÆ©Ë∫´Â§Ñ UTC ÁöÑÊàëÂø´ÈÄüËÆøÈóÆ CST ÁöÑÂÜÖÂÆπÂàôÊàê‰∏∫‰∫Ü‰∏ã‰∏Ä‰∏™‰ºÅ‰∏öÁ∫ßÈöæÈ¢ò„ÄÇÂØπ‰∫éÁúüÊ≠£ÁöÑ‰ºÅ‰∏öÊù•ËØ¥ÔºåÂΩìÁÑ∂‰∏çÈöæÔºö</p>
<ol>
<li>IPLC/IEPL Áõ¥Êé•Êãâ‰∏ìÁ∫øÔºõ‰ΩÜÔºåÊ®™Ë∑®‰∫öÊ¨ßÂ§ßÈôÜÔºåÊàëÁõ∏‰ø°‰πü‰∏çÊòØÂ§öÂ∞ë‰ºÅ‰∏öÂèØ‰ª•ÊâøÊãÖÂæóËµ∑ËøôÊ†∑ÁöÑ‰∏ìÁ∫ø</li>
<li>SD-WAN  ‰æùÊâòÊúçÂä°ÂïÜÊèê‰æõÁöÑÂÖ®ÁêÉ‰º†ËæìÁΩëÁªúÔºåÈÄöËøá SDN ÊäÄÊúØÂà∞Ëææ‰∏çÂêåÁöÑ POP ÁÇπ</li>
</ol>
<p>ËÄÉËôëÂà∞Â≠ëÁÑ∂‰∏Ä‰∫∫ÁöÑÊàëÂπ∂Ê≤°ÊúâÂ§™ÂÆΩË£ïÁöÑÁªèË¥πÔºåÊúÄÁªàÊ≤°ÊúâÈÄâÊã©ÂçÅÂàÜÂ§çÊùÇÁöÑÊñπÊ°àÔºåËÄåÊòØ‰æùÊâòËµõÂçöËè©Ëê®<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>ÁöÑÂÖ®ÁêÉÂä†ÈÄüÁΩëÁªúÂÆûÁé∞ SD-WAN ÁöÑÈÉ®ÂàÜÂäüËÉΩ„ÄÇÂΩìÁÑ∂ÔºåÂπ∂‰∏çÊòØÂÖ®Á®ã‰ºÅ‰∏öÁ∫ßÔºåËÄåÊòØ‰∏ÄÂçä‰ºÅ‰∏öÁ∫ß„ÄÇÂÖàÊù•ËØ¥ËØ¥ËØ¥„ÄåËµ∑Â§ú„ÄçÁ∫ßÈÉ®ÂàÜÔºö</p>
<p>ËÄÉËôëÂà∞ËµõÂçöËè©Ëê®Âú® CST Âú∞Âå∫ÁöÑ‰ΩúÁî®ÊúâÈôêÔºåÂú®Á≠õÈÄâ‰∫ÜËÆ∏‰πÖÂêéÔºåÊàëÈÄâÊã©‰∫ÜÂá†‰∏™‰∏≠ËΩ¨ÁÇπÔºöHKG/AMS/LAX„ÄÇÂú®Ëøô‰∫õÂú∞ÊñπÈÄâÊã©Âªâ‰ª∑‰∏îÂìçÂ∫îËøÖÈÄüÁöÑÊú∫Âô®ÔºåÊé•ÂÖ•Âà∞ÊàëÁöÑËäÇÁÇπ‰πã‰∏≠Ôºå‰Ωú‰∏∫Âá∫Á´ôÁ¨¨‰∏ÄÊ≠•„ÄÇÊ≥®ÊÑèÔºåËøô‰∫õÊú∫Âô®Âπ∂Ê≤°ÊúâÊé•ÂÖ•ÈõÜÁæ§‰πã‰∏≠ÔºåÂè™ÊòØ‰Ωú‰∏∫‰∏≠ËΩ¨ÔºåÂú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÂÅöÂà∞‰∫ÜÈöîÁ¶ªÔºåÂõ†‰∏∫Âç≥‰ΩøËøô‰∫õÊú∫Âô®Ê≤¶Èô∑/ÊúçÂä°ÂïÜË∑ëË∑ØÊàëÁöÑÈõÜÁæ§‰πü‰∏ç‰ºöÊî∂Âà∞Â§™Â§ßÁöÑÁâµËøû<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>„ÄÇËá≥‰∫éÂ¶Ç‰Ωï‰∏≠ËΩ¨ÔºåÂàôÊòØ Wireguard+VxLAN ‰∏ÄÊääÊ¢≠ÂÜçÂä†‰∏ÄÁÇπÁÇπÁöÑ TCP ‰ª•Â∫îÂØπÂÖ®ÁêÉ ISP ÂØπ UDP ÁöÑÂä£Âåñ„ÄÇÂπ∂‰∏îÔºåÊàëÂπ∂Ê≤°ÊúâÂ∞Ü‰∏ªÊéßËäÇÁÇπ‰∏éÊµ∑Â§ñÊú∫Âô®‰∫íËÅîÔºåËøôÊ†∑‰πüÈôç‰Ωé‰∫Ü‰∏ªÊéßËäÇÁÇπË¢´ÊîªÁ†¥ÁöÑÈ£éÈô©„ÄÇËÄåËá≥‰∫é‰∏∫‰ªÄ‰πàËøôÊ†∑ÂèØ‰ª•ËÆøÈóÆÔºåÂ∞±ÂÖ®Èù† K8S ÁöÑ External IP ‰∫Ü:</p>
<ol>
<li>Âú®ÈÖçÁΩÆ MetalLB ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÈúÄË¶ÅÂàõÂª∫ External IP Ê±†ÔºåÂ∏∏ËßÑËÆæÁΩÆ‰∏≠ÔºåÊàë‰ª¨‰∏ÄËà¨‰ºöÊääÈÇ£‰∫õÂÖ¨ÁΩëÂèØËææÁöÑ IP ÊîæËøõÂéªÔºåÊØîÂ¶ÇÊàëËøôÈáåÁöÑËÖæËÆØ‰∫ëÁöÑ IPÔºõ‰ΩÜÂú®ÊàëËøôÂ•óÊñπÊ°à‰∏≠Ôºå‰ªÖÈúÄË¶ÅÊää worker ÁöÑÂÜÖÁΩë IP ÊîæÂÖ•Âç≥ÂèØÔºö
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">metallb.io/v1beta1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">IPAddressPool</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ip-pool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">metallb-system</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">addresses</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">192.168.101.101-192.168.101.102</span> <span style="color:#75715e"># Riemann Âíå Nexus ÁöÑÂÜÖÁΩë IPÔºåÈúÄË¶Å‰∏ªÊéßËäÇÁÇπ‰πüÂèØ‰ª•ËÆøÈóÆÁöÑ IP</span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">metallb.io/v1beta1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">L2Advertisement</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">public-ip</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">metallb-system</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ipAddressPools</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">ip-pool</span>
</span></span></code></pre></div></li>
<li>ÈÖçÁΩÆ Ingress ControllerÔºåÊàëÁõÆÂâçÈÄâÊã©ÁöÑÊòØÂÆòÊñπÁöÑ <a href="https://github.com/kubernetes/ingress-nginx">ingress-nginx-controller</a>ÔºõÂ¶ÇÊûúÊÉ≥Ë¶ÅÂÖÖÂàÜÂà©Áî® IP Ê±†‰∏≠ÁöÑÊâÄÊúâ IPÔºå Êàë‰ª¨ÂàôÈúÄË¶ÅÂàÜÂà´ÂàõÂª∫‰∏§‰∏™ ingress controllerÔºö
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ÊØè‰∏Ä‰∏™ ingress controller ÈÉΩÊòØ Load BalancerÔºå ÊâÄ‰ª•‰∏ÄÂÖ±ÂèØ‰ª•ÊãøÂà∞‰∏§‰∏™ IP</span>
</span></span><span style="display:flex;"><span>helm upgrade --install ingress-nginx-a ingress-nginx --repo https://kubernetes.github.io/ingress-nginx --namespace ingress-nginx-a --create-namespace
</span></span><span style="display:flex;"><span>helm upgrade --install ingress-nginx-b ingress-nginx --repo https://kubernetes.github.io/ingress-nginx --namespace ingress-nginx-b --create-namespace
</span></span></code></pre></div></li>
<li><code>IPTABLES</code> ‰∏ÄÊääÊ¢≠ÔºåËÆ©Â§ñÈÉ®ÊúçÂä°Âô®ËøõË°åÁ´ØÂè£ËΩ¨ÂèëÔºåÂΩìÁÑ∂Ôºå‰πüÂèØ‰ª•ÈÄâÊã©ÂÖ∂‰ªñÂ∑•ÂÖ∑Ôºö
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;net.ipv4.ip_forward = 1&#34;</span> | sudo tee /etc/sysctl.conf
</span></span><span style="display:flex;"><span>sudo iptables -t nat -A PREROUTING -p tcp -m multiport --dport 80,443 -j DNAT --to-destination 192.168.101.101:80
</span></span><span style="display:flex;"><span>sudo iptables -t nat -A POSTROUTING -p tcp -d 192.168.101.101 -m multiport --dport 80,443 -j SNAT --to-source 192.168.101.2
</span></span></code></pre></div></li>
</ol>
<p>‰∏âÊ≠•Ëµ∞‰ª•ÂêéÔºå„ÄåËµ∑Â§ú„ÄçÁ∫ßÁöÑÈìæË∑ØÂ∞±ÊûÑÈÄ†ÂÆåÊàê‰∫ÜÔºåËøôÊó∂Âè™ÈúÄË¶ÅÊàë‰ª¨Â∞ÜÂüüÂêçËß£ÊûêÂà∞Â§ñÈÉ®ÊúçÂä°Âô®ÁöÑ IP ‰∏äÂç≥ÂèØËÆøÈóÆÈõÜÁæ§ÂÜÖÈÉ®ÈÉ®ÁΩ≤ÁöÑ web ÊúçÂä°„ÄÇ‰∏çËøáÔºåÂè™Êúâ‰∏â‰∏™ËäÇÁÇπÊÄé‰πàÊúçÂä°ÂÖ®ÁêÉÔºåËøòÊòØ‰∏çÂ§üÂÖ®Èù¢„ÄÇ‰∏Ä‰∏™‰ºÅ‰∏öÁ∫ßÁöÑÊñπÊ°à‰∏ÄÂÆöË¶ÅÂÅöÂà∞ÂÖ®ÁêÉË¶ÜÁõñ„ÄÇÈÇ£Ê≠§Êó∂Â∞±ÈÇÄËØ∑Âà∞ËµõÂçöËè©Ëê®ÁôªÂú∫‰∫Ü„ÄÇCloudflare ÁªôÊØè‰∏™Áî®Êà∑ÈÉΩÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÈößÈÅìÊúçÂä°Âè´ÂÅö <a href="https://www.cloudflare.com/products/tunnel/">„ÄåCloudflare Tunnel„Äç</a>:</p>
<blockquote>
<p>Cloudflare Tunnel provides you with a secure way to connect your resources to Cloudflare without a publicly routable IP address. With Tunnel, you do not send traffic to an external IP ‚Äî instead, a lightweight daemon in your infrastructure (cloudflared) creates outbound-only connections to Cloudflare‚Äôs global network. Cloudflare Tunnel can connect HTTP web servers, SSH servers, remote desktops, and other protocols safely to Cloudflare. This way, your origins can serve traffic through Cloudflare without being vulnerable to attacks that bypass Cloudflare.
ÊëòËá™ <a href="https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/">Cloudflare Tunnel ÂÆòÊñπÊñáÊ°£</a></p>
</blockquote>
<p>ËøôÈáåÊèêÂà∞ÔºåCloudflare ÂÆûÈôÖ‰∏äÊòØ‰ªéÂÜÖÁΩëÁõ¥Êé•Âà∞ Cloudflare ÁöÑËæπÁºòËäÇÁÇπÔºåËÄå‰∏çÈúÄË¶ÅÊúçÂä°ÈÉ®ÁΩ≤Âú®‰∏Ä‰∏™ÂÖ¨ÁΩëÂèØËææÁöÑÊúçÂä°Âô®‰∏äÔºå‰ΩÜÊòØÂú®ËøôÈáåÔºåÊàëÂú®Áõ¥Â∞Ü‰∏â‰∏™ÂÖ¨ÁΩëÂèØËææÁöÑÊúçÂä°Âô®‰Ωú‰∏∫ËøûÊé•ËæπÁºòËäÇÁÇπÂíåÊ∫êÊúçÂä°Âô®ÁöÑ‰∏≠Èó¥Ë∑≥ÊùøÔºåËÄåÂÖ∂‰∏≠ÁöÑË∑≥ÊùøÂ∞±ÊòØ CF Tunnel„ÄÇËøôÊ†∑Â∏ÉÁΩÆÁöÑÂ•ΩÂ§ÑÊòØÔºåÊàë‰ª¨ÁöÑÂõûÊ∫êË∑ØÂæÑ‰∏çÈúÄË¶ÅÁªèËøáÁ∫∑ÁπÅÂ§çÊùÇÁöÑÂÖ¨ÁΩëÁªèËøáÊó†Êï∞ÁöÑ pop ÂíåÊó†Â∞ΩÁöÑÁªïË∑ØÔºåË¢´ BGP ËΩ¨ÁöÑÊôïÂ§¥ËΩ¨ÂêëÔºåÊúÄÁªàÈÅóÂ§±Âú®Â§™Âπ≥Ê¥ãÔºõÊµÅÈáèÂú®ËøõÂÖ• CF Tunnel ‰ºöÂéªÂØªÊâæÁ¶ªËá™Â∑±ÊúÄËøëÁöÑ‚ÄúÊ∫ê‚ÄùÁ´ôÔºåÁÑ∂Âêé‰∏ã‰∏ÄË∑≥Â∞±ÊòØ‚ÄùÊ∫ê‚ÄúÁ´ôÔºàÈõÜÁæ§Ôºâ‰∫Ü<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>„ÄÇ Tunnel ‰ºöËá™Âä®ÂØªÊâæÊúÄËøëÁöÑ‚ÄúÊ∫ê‚ÄùÁ´ô‰πüÊòØÂÆòÊñπÊñáÊ°£ÊèêÂèäÁöÑÔºö</p>
<blockquote>
<p>By design, replicas(ÊòØÊåá cloudflared replicas) do not offer any level of traffic steering (random, hash, or round-robin). Instead, when a request arrives to Cloudflare, <strong>it will be forwarded to the replica that is geographically closest</strong>. If that distance calculation is unsuccessful or the connection fails, we will retry others, but there is no guarantee about which connection is chosen.</p>
</blockquote>
<p>ÂØπ‰∫é Cloudflare Êù•ËØ¥ÔºåÂèØËÉΩ‰ªòË¥πÁî®Êà∑ÈúÄË¶ÅÁöÑÊòØ traffic steeringÔºå‰ΩÜÂÆûÈôÖ‰∏äÔºåÊàëÈúÄË¶ÅÁöÑÊòØ geo steering„ÄÇËá™Ê≠§Ôºö</p>
<ol>
<li>ÁæéÊ¥≤Áî®Êà∑Â§ßÊ¶ÇÁéá‰ºöËøõÂÖ•ÈößÈÅìÂà∞Ëææ LAXÔºåÁÑ∂ÂêéË∑®Ë∂äÂ§™Âπ≥Ê¥ãÂõûÊ∫êÔºõ</li>
<li>Ê¨ßÊ¥≤ÂíåÈÉ®ÂàÜ‰∫öÁªÜ‰∫öÁî®Êà∑‰ºöÂà∞ AMSÔºåÁÑ∂ÂêéËµ∞‰∫¨Âæ∑Á∫øË∑ØÂõûÊ∫êÔºõ</li>
<li>ÂÖ∂‰ªñ‰∫öÁªÜ‰∫öÂíåÂ§ßÊ¥ãÊ¥≤Áî®Êà∑‰ºöÂà∞Ëææ HKGÔºåÁÑ∂ÂêéÂõûÊ∫êÔºõ</li>
<li>ÁõÆÂâçÔºåÊ≤°ÊúâÊµãËØïËøáÈùûÊ¥≤ÁöÑ‰ΩìÈ™åÔºåÊâÄ‰ª•ÊöÇ‰∏îÊ≤°ÊúâÁªìÊûú„ÄÇ</li>
</ol>
<p>ÁêÜËÆ∫‰∏ä‰ºº‰πé‰ºöÊúâÂä†ÈÄüÔºåÈÇ£ÂÆûÈôÖ‰∏äÊµãËØïÂë¢ÔºüÊàëÁî® <a href="https://www.dotcom-tools.com/">dotcom-tools</a> ÂØπÁΩëÁ´ôÊâìÂºÄÈÄüÂ∫¶ËøõË°åÊµãËØïÔºåÈÄâÂèñ‰∫ÜÈ©¨Âæ∑Èáå„ÄÅÂçéÁõõÈ°øÂíåÈ¶ôÊ∏ØËøõË°åÊµãËØïÔºåÊïàÊûúÂ¶Ç‰∏ãÂõæÔºåÂèØ‰ª•ÁúãÂà∞‰∏âÂú∞Âπ≥ÂùáËÆøÈóÆÈÄüÂ∫¶Á°ÆÂÆûÊòØÊúâÊâÄÊèêÂçáÔºåËÄåÂÖ∂‰∏≠ÂçéÁõõÈ°øÂú∞Âå∫ÁöÑÊµãËØï‰∏çÂçáÂèçÈôçÔºåËøô‰∏™ÂèØËÉΩÊòØÊú¨Ë∫´ÊµãËØïËäÇÁÇπÂà∞‚ÄúÊ∫ê‚ÄùÁ´ôÁöÑË∑ØÁî±ÊØî CF ÁöÑÂ•ΩÂêßÔºå‰πüÊúâÂèØËÉΩ CF Â∏¶Ëøô‰∫õÊµÅÈáèÂéª‰∫ÜÊ¨ßÊ¥≤ÔºåËøôÂ∞±‰∏çÂæóËÄåÁü•‰∫Ü„ÄÇ‰∏çËøáÊÄª‰ΩìËÄåË®ÄÔºåÂÆûÈ™åÂ∫îÂΩìÁÆó‰ΩúÊàêÂäü„ÄÇ</p>
<table>
    <tr>
        <td><img src="https://32cf906.webp.li/2024/08/media-before-cf.png" /></td>
        <td><img src="https://32cf906.webp.li/2024/08/media-cf-speedup.png"/></td>
    </tr>
    <tr>
        <td><center>Before</center></td>
        <td><center>After</center></td>
    </tr>
</table>
<p>Ëá™Ê≠§ÔºåÂÖ®ÁêÉÂä†ÈÄüÈÉ®ÂàÜÂà∞Ê≠§ÁªìÊùü„ÄÇÂ§ßÊ¶ÇÁöÑÊúâÁÇπÊúâÂ¶Ç‰∏ãÂá†Êù°Ôºö</p>
<ol>
<li>‰ªªÊÑèÊ∑ªÂä†Êé•ÂÖ•ÁÇπÔºöÊàë‰ª¨‰ªÖÈúÄË¶ÅËÆ©Êñ∞Â¢ûËäÇÁÇπÂíåÈõÜÁæ§Âª∫Á´ãÈÄöÁïÖËøûÊé•ÔºåÂç≥ÂèØÈöèÊó∂Â¢ûÔºàÂà†ÔºâÊé•ÂÖ•ÁÇπÔºå‰∏ªË¶ÅÁõÆÁöÑÊòØÁî®Êù•Â∫îÂØπ‰∏çÂêåÁΩëÁªúÊ≥¢Âä®Âíå VPS ÊúçÂä°ÂïÜ SLA ÊÉÖÂÜµ„ÄÇ</li>
<li>ÈöêËóèÊ∫êÁ´ôÂíåÈôç‰ΩéË¥πÁî®ÔºöÂ¶ÇÊûú‰ΩøÁî® GeoDNS Âíå CDN ËøõË°åÂä†ÈÄüÔºåÂàôÈúÄË¶ÅÊîØ‰ªò DNS ÂàÜÂå∫Ëß£ÊûêÂíåÂØπÂ∫î CDN ÁöÑË¥πÁî®„ÄÇ‰ºóÊâÄÂë®Áü•ÔºåËµõÂçöËè©Ëê®ÁöÑ DNS Ê≤°ÊúâÂàÜÂå∫Ëß£ÊûêÔºåGeo steering ÈúÄË¶Å‰ªòË¥π„ÄÇ</li>
</ol>
<p>ÂΩìÁÑ∂ÔºåÂÆûÈôÖ‰∏äÊñπÊ°à‰æùÊóßÂ≠òÂú®Áº∫Èô∑Ôºå‰æãÂ¶ÇÔºåÊé•ÂÖ•ÁÇπÂíåÈõÜÁæ§ËøûÊé•ÈúÄË¶ÅÊâãÂä®ÈÖçÁΩÆÔºåCF Ë∑ØÁî±ÈªëÁÆ±„ÄÇÂΩìÁÑ∂ÔºåÂâçËÄÖÊòØÊàëÁöÑÈóÆÈ¢òÔºåÂêéËÄÖ‰πüÊòØÊàëÁöÑÈóÆÈ¢ò„ÄÇ</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>ÂÆûÈôÖ‰∏äÊúâ‰∫õÂêéÊÇîÔºå‰∏∫‰ªÄ‰πà‰∏çÊòØÂ≠òÂÇ®ËäÇÁÇπÂè´ÂÅö Nexus ËÆ°ÁÆóËäÇÁÇπ RiemannÔºåËøôÊ†∑ÊâçÁ¨¶Âêà‰∫∫ËÆæ„ÄÇ&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>ËµõÂçöËè©Ëê®‰πãÊâÄ‰ª•ÊòØËè©Ëê®ÔºåÊòØÂõ†‰∏∫ÂñÑ„ÄÇ&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Ëøô‰πüÊòØ‰∏∫‰ªÄ‰πàÊàëÈÄâÊã©ËÖæËÆØ‰∫ëÁöÑÊúçÂä°Âô®‰Ωú‰∏∫‰∏ªÊéßËäÇÁÇπÁöÑÂéüÂõ†ÔºåÊØïÁ´üÊòØÂ§ßÂéÇ„ÄÇ&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>ËøôÈáåÊèêÂà∞ÁöÑ„Äå‰∏ã‰∏ÄË∑≥„ÄçÊòØÊåá overlay ÁΩëÁªúÈáåÁöÑÔºåÂÆûÈôÖ‰∏äËøòÊòØÈúÄË¶ÅÁªèËøáÂæàÂ§ö popÔºåÂè™‰∏çËøáÂõ†‰∏∫ÈÉΩÂú®Ëøô‰∏™Â§ßÂÜÖÁΩëÈáå‰∏ç‰ºöË¢´Â±ïÁ§∫Âá∫Êù•„ÄÇ&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
</content>

<p>
  
  <a href="https://blog.cklau.cc/tags/homelab/">#homelab</a>
  
  <a href="https://blog.cklau.cc/tags/networking/">#networking</a>
  
  <a href="https://blog.cklau.cc/tags/hardware/">#hardware</a>
  
  <a href="https://blog.cklau.cc/tags/%E7%BD%91%E7%BB%9C/">#ÁΩëÁªú</a>
  
  <a href="https://blog.cklau.cc/tags/%E5%AD%98%E5%82%A8/">#Â≠òÂÇ®</a>
  
  <a href="https://blog.cklau.cc/tags/nas/">#NAS</a>
  
</p>

  </main>
  <footer>


<p>
    <span><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">Á≤§ICPÂ§á2022102668Âè∑</a></span>

&copy; 2024 <a href="https://blog.cklau.cc">Junjie LIU</a>
    <a href="https://blog.cklau.cc/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
    <br>
Hosting and images served by <a href="https://cloud.tencent.com/">Tencent Cloud</a> / <a href="https://cloudflare.com/">Cloudflare</a> / <a href="https://webp.se/">WebP Cloud Services</a>
</p>

</footer>

    
</body>

</html>
